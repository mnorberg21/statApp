
FROM alpine:3.16

WORKDIR /home/project

COPY server .
COPY requirements.txt requirements.txt

RUN apk update && apk upgrade --available; \
    apk add --update python3; \
    apk add py3-pip; \
    apk add make automake gcc g++ subversion; \
    apk add --upgrade python3-dev; \
    apk add --upgrade libpq-dev;

RUN pip install -r requirements.txt

ENV FLASK_APP=serve.py

RUN flask db init; \
    flask db migrate; \
    flask db upgrade;

CMD ["python", "-u", "serve.py"]
